<title>EmuWOW</title>

<h1><strong>EmuWOW</strong></h1>
<p>Throughout my senior year of high school, I wrote a program known as EmuWOW to enable running applications designed for Windows NT for the MIPS and Alpha AXP architectures to run on readily-available x86/x64 PCs. Essentially, it's the inverse of the WX86 emulator that Microsoft published for the RISC versions of Windows. This project was featured on <a href="https://virtuallyfun.com/2024/02/17/announcing-emuwow-beta-1-axp-preview1/">VirtuallyFun</a> twice in January and February of 2024. It works by implementing a custom loader for the Windows Portable Executable (PE) format, loading the emulated executable into the process address space, and beginning to execute the executable's entry point within the emulator. At this point, any DLLs it needs to load that export Win32 API procedure entry points will also be loaded. To allow the emulated programs to call the Win32 APIs, it was necessary to "thunk" API calls between the emulator and the host; an illegal instruction within the emulated DLLs was used to trap and transfer control out to the host DLLs. Substantial success was had running many of the built-in Windows applets from Windows NT version 3.51.</p>

<p>Throughout this project, I not only learned a lot about all of the CPU architectures supported by EmuWOW, since I had to write emulators for each of them, but also about the internal details of Windows and the Win32 API. Through my experiences thunking Win32 API calls and debugging real Win32 apps running under my emulator, having to maintain Win32 data structures such as the Process Environment Block (PEB) and Thread Environment Block (TEB) that are often poorly documented, I learned more about Win32 than most people would care to know. In fact, I since learned that this emulator is not dissimilar in concept from an emulator designed by security researcher Silvio Cesare, who used his emulator as a sandbox for malware analysis, to debug malware that is able to resist normal debuggers.</p>