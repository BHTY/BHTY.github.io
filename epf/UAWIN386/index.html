<title>Unauthorized Windows/386</title>

<h1><strong>Unauthorized Windows/386</strong></h1>
<p>I did some reverse-engineering work on Microsoft Windows/386 version 2.xx that even ended up with me writing another <a href="https://virtuallyfun.com/2025/09/06/unauthorized-windows-386/">VirtuallyFun blog post</a> which went onto blow up on HackerNews along with a few other tech news aggregators. This version of Windows, dating to 1987, is very historically significant for being one of the first operating systems to take advantage of the 80386's ability to multitask real-mode programs using Virtual 8086 Mode, but it has been virtually undocumented even though its successors, such as Windows versions 3.0, 3.1, and 4.0 (better known as Windows 95 aka "Chicago") have had a littany of writeups about them. In fact, the "virtual machine manager" architecture of Windows 3.0 enhanced mode and above with virtual device drivers has its roots in Windows/386.</p>

<p>To begin my work, I first had to convert the kernel of Windows/386 into a more modern executable format compatible with modern analysis tools, so I wrote my own converter program to accomplish this. After that, I could begin disassembling Windows/386 and figuring out how its code worked. Unlike later versions of Windows, the virtual device drivers that comprise Windows/386's 32-bit layer are statically linked into the kernel rather than loaded as separate files, so it was previously thought to be impossible to load custom code to run in 32-bit mode in Windows/386, but by writing my own program that hijacked the Windows/386 loader and patched key interrupt vectors, I was able to interrupt execution of Windows/386 and detour into my own code on command.</p>

<p>This project taught me a great deal about reverse-engineering, which is one of my core work interests. Beyond simply sharpening my abilities of x86 assembly, and recognizing patterns to piece together inscrutable-looking disassemblies, I became more proficient in building tools, since I needed to build tools to convert between different executable formats to aid in my work, and became more adept with software archaeology, as I looked into clues from other versions of Windows to help piece together clues to how Windows/386 worked.</p>
