<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_1grmpup5b7ab-6>li:before{content:"\0025cf   "}.lst-kix_1grmpup5b7ab-7>li:before{content:"\0025cb   "}.lst-kix_1grmpup5b7ab-8>li:before{content:"\0025a0   "}.lst-kix_4kevw8dlv5g2-1>li:before{content:"\0025cb   "}ul.lst-kix_7ovw6qxcj59p-8{list-style-type:none}.lst-kix_4kevw8dlv5g2-0>li:before{content:"\0025cf   "}.lst-kix_4kevw8dlv5g2-2>li:before{content:"\0025a0   "}ul.lst-kix_1grmpup5b7ab-8{list-style-type:none}ul.lst-kix_1grmpup5b7ab-4{list-style-type:none}ul.lst-kix_7ovw6qxcj59p-0{list-style-type:none}.lst-kix_7ovw6qxcj59p-7>li:before{content:"\0025cb   "}ul.lst-kix_1grmpup5b7ab-5{list-style-type:none}ul.lst-kix_7ovw6qxcj59p-1{list-style-type:none}ul.lst-kix_1grmpup5b7ab-6{list-style-type:none}ul.lst-kix_7ovw6qxcj59p-2{list-style-type:none}.lst-kix_7ovw6qxcj59p-8>li:before{content:"\0025a0   "}ul.lst-kix_1grmpup5b7ab-7{list-style-type:none}ul.lst-kix_7ovw6qxcj59p-3{list-style-type:none}ul.lst-kix_1grmpup5b7ab-0{list-style-type:none}ul.lst-kix_7ovw6qxcj59p-4{list-style-type:none}ul.lst-kix_1grmpup5b7ab-1{list-style-type:none}ul.lst-kix_7ovw6qxcj59p-5{list-style-type:none}ul.lst-kix_1grmpup5b7ab-2{list-style-type:none}ul.lst-kix_7ovw6qxcj59p-6{list-style-type:none}ul.lst-kix_1grmpup5b7ab-3{list-style-type:none}ul.lst-kix_7ovw6qxcj59p-7{list-style-type:none}.lst-kix_uqb49g1g00nf-5>li:before{content:"\0025a0   "}.lst-kix_uqb49g1g00nf-4>li:before{content:"\0025cb   "}.lst-kix_uqb49g1g00nf-3>li:before{content:"\0025cf   "}.lst-kix_uqb49g1g00nf-2>li:before{content:"\0025a0   "}.lst-kix_uqb49g1g00nf-6>li:before{content:"\0025cf   "}.lst-kix_uqb49g1g00nf-7>li:before{content:"\0025cb   "}.lst-kix_uqb49g1g00nf-1>li:before{content:"\0025cb   "}.lst-kix_uqb49g1g00nf-0>li:before{content:"\0025cf   "}.lst-kix_uqb49g1g00nf-8>li:before{content:"\0025a0   "}ul.lst-kix_4kevw8dlv5g2-8{list-style-type:none}ul.lst-kix_4kevw8dlv5g2-6{list-style-type:none}ul.lst-kix_4kevw8dlv5g2-7{list-style-type:none}ul.lst-kix_4kevw8dlv5g2-0{list-style-type:none}.lst-kix_7ovw6qxcj59p-3>li:before{content:"\0025cf   "}ul.lst-kix_4kevw8dlv5g2-1{list-style-type:none}.lst-kix_4kevw8dlv5g2-8>li:before{content:"\0025a0   "}.lst-kix_7ovw6qxcj59p-2>li:before{content:"\0025a0   "}.lst-kix_7ovw6qxcj59p-4>li:before{content:"\0025cb   "}ul.lst-kix_4kevw8dlv5g2-4{list-style-type:none}ul.lst-kix_4kevw8dlv5g2-5{list-style-type:none}ul.lst-kix_4kevw8dlv5g2-2{list-style-type:none}ul.lst-kix_4kevw8dlv5g2-3{list-style-type:none}ul.lst-kix_uqb49g1g00nf-6{list-style-type:none}ul.lst-kix_uqb49g1g00nf-5{list-style-type:none}.lst-kix_4kevw8dlv5g2-4>li:before{content:"\0025cb   "}.lst-kix_7ovw6qxcj59p-6>li:before{content:"\0025cf   "}ul.lst-kix_uqb49g1g00nf-4{list-style-type:none}ul.lst-kix_uqb49g1g00nf-3{list-style-type:none}.lst-kix_4kevw8dlv5g2-3>li:before{content:"\0025cf   "}.lst-kix_7ovw6qxcj59p-5>li:before{content:"\0025a0   "}ul.lst-kix_uqb49g1g00nf-2{list-style-type:none}ul.lst-kix_uqb49g1g00nf-1{list-style-type:none}ul.lst-kix_uqb49g1g00nf-0{list-style-type:none}.lst-kix_1grmpup5b7ab-0>li:before{content:"\0025cf   "}.lst-kix_1grmpup5b7ab-1>li:before{content:"\0025cb   "}.lst-kix_1grmpup5b7ab-3>li:before{content:"\0025cf   "}ul.lst-kix_uqb49g1g00nf-8{list-style-type:none}.lst-kix_1grmpup5b7ab-2>li:before{content:"\0025a0   "}ul.lst-kix_uqb49g1g00nf-7{list-style-type:none}.lst-kix_4kevw8dlv5g2-5>li:before{content:"\0025a0   "}.lst-kix_4kevw8dlv5g2-6>li:before{content:"\0025cf   "}.lst-kix_7ovw6qxcj59p-0>li:before{content:"\0025cf   "}.lst-kix_1grmpup5b7ab-5>li:before{content:"\0025a0   "}.lst-kix_4kevw8dlv5g2-7>li:before{content:"\0025cb   "}.lst-kix_7ovw6qxcj59p-1>li:before{content:"\0025cb   "}.lst-kix_1grmpup5b7ab-4>li:before{content:"\0025cb   "}ol{margin:0;padding:0}table td,table th{padding:0}.c3{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:156pt;border-top-color:#000000;border-bottom-style:solid}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Times New Roman";font-style:normal}.c6{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Times New Roman";font-style:normal}.c2{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c5{border-spacing:0;border-collapse:collapse;margin-right:auto}.c10{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c9{font-weight:700;font-family:"Times New Roman"}.c7{font-weight:400;font-family:"Times New Roman"}.c8{height:11pt}.c4{height:0pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c10 doc-content"><p class="c2"><span class="c9">Improving the debugger</span></p><p class="c2"><span class="c1">EmuWoW&rsquo;s debugger is currently a little weak; it can be helpful, but it&rsquo;s still quite limited. For one thing, there&rsquo;s no symbolic debugging; everything is done in terms of raw addresses. The problem is that symbols in Win32 PE images are given in a few formats, of three main types - COFF symbols, CodeView symbols, and PDB symbols. PDB symbols are emitted as a separate file, while COFF and CodeView symbols are part of the EXE (though they can be &ldquo;stripped&rdquo; from the image file - the DBG files on the Windows NT CD-ROMs are PE files that only contain debug symbols and no executable code, each paired with a driver, DLL, or EXE on the CD). In my case, I implemented support for COFF symbols because they&rsquo;re simple and easily emitted by Visual C++, up to version 6.0. I&rsquo;ll still need to add support for loading DBG files.</span></p><p class="c2 c8"><span class="c1"></span></p><p class="c2"><span class="c1">Writing a COFF parser was easy, and there are now rudimentary symbol resolution capabilities, but they have to be invoked manually (i.e. they won&rsquo;t show up as hints for branch targets or in the debugger next to your PC, you have to either type in a symbol+offset and get an address, or type an address and have it try to find the closest symbol). I&rsquo;m not 100% sure how I&rsquo;ll handle printing function offsets vs machine-generated labels yet. I also fixed the module relocator, and also added the ability to remotely pause/break an executable, rather than having to explicitly set breakpoints ahead of time. I&rsquo;d love to add stack tracing with the K key, but I&rsquo;m not sure how to do that for MIPS or Alpha yet.</span></p><p class="c2 c8"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 321.33px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 321.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c8"><span class="c6"></span></p><p class="c2"><span class="c9">Alpha News</span></p><p class="c2"><span class="c1">Currently, EmuWoW&rsquo;s DEC Alpha support is rather primitive. Most applications won&rsquo;t respond to most window messages, including clicks to the menu (though they&rsquo;re still pumping messages so Windows won&rsquo;t think the app is hanging), a lot of apps are broken in some way or another if they launch at all, and so on. I&rsquo;m not 100% sure about the cause, but I&rsquo;m willing to bet some of it is down to MAME&rsquo;s Alpha AXP emulator, which doesn&rsquo;t look to have been maintained in a while and is rather barebones. QEMU&rsquo;s Alpha AXP emulator, on the other hand, is much more advanced and being actively developed, so I&rsquo;m going to try slotting that in. QEMU is not currently capable of booting Windows NT, but it can boot VMS and Tru64, and if it&rsquo;s accurate enough for those, it should be accurate enough for NT user-mode programs.</span></p><p class="c2 c8"><span class="c1"></span></p><p class="c2"><span class="c1">On the bright side, I may have an Alpha box on the way so that I can single-step through Alpha programs on there and compare with EmuWoW.</span></p><p class="c2 c8"><span class="c1"></span></p><p class="c2"><span class="c6">Roadmap from here</span></p><p class="c2"><span class="c1">The roadmap from here actually seems pretty smooth. I&rsquo;ll have to hook a couple of the image-loader related functions to deal with emulated images (GetModuleHandle, LoadLibrary, GetProcAddress, etc.), and I also plan to hook ExitProcess (and the crash screen) to flush stdout, so that crash dumps aren&rsquo;t truncated. </span></p><p class="c2 c8"><span class="c1"></span></p><p class="c2"><span class="c7">Before I can get the real awesome stuff (compilers and Doom), I first have to get the built-in Windows applets all working correctly. Here&rsquo;s the compatibility chart as of now:</span></p><p class="c2 c8"><span class="c1"></span></p><a id="t.789d6b7f797268ef4b2d382e3b2542d3e9c2897c"></a><a id="t.0"></a><table class="c5"><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0 c8"><span class="c1"></span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">MIPS</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Alpha</span></p></td></tr><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Notepad</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Crashes due to unimplemented FPU instructions in CRTDLL</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Opens but is unresponsive to input</span></p></td></tr><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Paintbrush</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Works but is buggy</span></p><p class="c0"><span class="c1">Mouse becomes &ldquo;locked&rdquo; into PaintBrush tools until you swap focus</span></p><p class="c0"><span class="c1">Crashes due to unimplemented FPU instructions when you try to open a file</span></p><p class="c0"><span class="c1">Saving doesn&rsquo;t work</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Opens but is unresponsive to input</span></p><p class="c0"><span class="c1">UI is squished to the tiny left side</span></p></td></tr><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Clock</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Digital clock only works with system font, positioned wrong</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Opens but is unresponsive to input (though dialog boxes will open from the menus)</span></p></td></tr><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Reversi</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Works but is buggy</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Crashes in _setmbcp</span></p></td></tr><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Cardfile</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Works more-or-less perfectly</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Opens but is broken and unresponsive</span></p></td></tr><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Terminal</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Works more-or-less perfectly</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Opens but is broken and unresponsive</span></p></td></tr><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">WinMine</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Works perfectly</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Some kind of error state</span></p></td></tr><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Solitaire</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Opens but crashes when you click on the card more than once</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Opens window but crashes immediately</span></p></td></tr><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">FreeCell</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Works perfectly</span></p></td><td class="c3" colspan="1" rowspan="1"><p class="c0"><span class="c1">Opens and is responsive, but crashes when you start a game due to trying to dereference past the end of the image</span></p></td></tr></table><p class="c2 c8"><span class="c1"></span></p><p class="c2"><span class="c1">As you can see, MIPS is working reasonably well, but still has some ways to go. Alpha, on the other hand, is still in a very basic state and has a lot of work to do. At the time of writing, all of the changes I&rsquo;ve described as having done are in the repo. I expect to be writing my next dev log when I&rsquo;ve completed the next incremental milestone: hooking ExitProcess (a quick fix) and integrating QEMU&rsquo;s Alpha emulator.</span></p></body></html>